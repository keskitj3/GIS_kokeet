<html>

<head>

<script src="ext-3.4.0/adapter/ext/ext-base.js" type="text/javascript"></script>
<script src="ext-3.4.0/ext-all.js"  type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="ext-3.4.0/resources/css/ext-all.css"></link>

<script src="openlayers/OpenLayers.js" type="text/javascript"></script>

<script src="geoext/script/GeoExt.js" type="text/javascript"></script>

<script type="text/javascript">

Ext.onReady(function() {

  var world = new OpenLayers.Layer.WMS(
     "Global Imagery",
     "/geoserver/wms/",
     {layers: "earthgroup"}
  );

  var smallworld = new OpenLayers.Layer.Vector(
      "Small World", {
      strategies: [new OpenLayers.Strategy.Fixed()],
      protocol: new OpenLayers.Protocol.WFS({
             url: "/geoserver/wfs",
             featureType: "smallworld",
             featureNS: "http://geoserver.org/earth"
      })
  });

  var mapwin = new Ext.Window({
     title: "GeoExt Map 1",
     width: 600,
     height: 400,
     layout: "fit",
     items: {
       xtype: "gx_mappanel",
       layers: [world, smallworld]
     }
  });

  var popup;
  function createPopup(feature) {
      popup = new GeoExt.Popup({
             title: "It's a Small World",
             location: feature,
             width:200,
             html: feature.attributes.placename + "<br/>" + feature.attributes.comment + "<br/>" + feature.attributes.year + "<br/>",
             maximizable: true,
             collapsible: true
      });
      popup.show();
  }

  smallworld.events.on({
    featureselected: function(e) {
      createPopup(e.feature);
    }
  });

  var selectCtrl = new OpenLayers.Control.SelectFeature(smallworld);

  var mapPanel;
  mapPanel = mapwin.items.get(0);
  mapPanel.map.addControl(selectCtrl);
  selectCtrl.activate();

  mapwin.show();

});

</script>

</head>

<body><!-- Oh no you didn't !!! --></body>

</html>
